const url=window.location.href,connectedStr="Connected",disconnectedStr="Disconnected",components=[],content=document.getElementById("content"),title=document.getElementById("title"),loadingInfo=document.getElementById("info"),isConnectedDiv=document.getElementById("isConnected");content.style.overflow="scroll",console.log(content.style.width);const initialFetch=async()=>{fetch(`${url}init`).then((e=>e.text())).then((e=>{console.log(e),title.innerHTML=e.toString(),document.title=e.toString()}))},getData=async()=>{await fetch(`${url}input`).then((e=>200===e.status?(console.log("OK"),e.json()):204===e.status?null:void 0)).then((e=>{null!==e&&(renderData(e),components.forEach((e=>{null===document.getElementById(e.name)&&content.appendChild(e.render()),isConnectedDiv.innerHTML="Connected",isConnectedDiv.style.color="#00a103",loadingInfo.innerHTML=""})))})).catch((e=>{console.log(e),isConnectedDiv.innerHTML="Disconnected",isConnectedDiv.style.color="#a10000"})),setTimeout(getData,500)},renderData=({elements:e})=>{console.log("render"),e.forEach((e=>{const o=getElementIfIsRendered(e);switch(e.componentType){case"switch":null===o&&components.push(new SwitchComponent({name:e.name,componentType:e.componentType,size:e.size,posX:e.posX,posY:e.posY,value:e.value,color:e.color,desktopScale:e.desktopScale}));break;case"label":null===o?components.push(new Label({name:e.name,componentType:e.componentType,posX:e.posX,posY:e.posY,value:e.value,fontSize:e.fontSize,isVertical:e.isVertical,color:e.color})):o.setState(e);break;case"gauge":null===o?components.push(new GaugeComponent({name:e.name,componentType:e.componentType,posX:e.posX,posY:e.posY,width:e.width,height:e.height,color:e.color,maxValue:e.maxValue,minValue:e.minValue,value:e.value})):o.setState(e);break;case"indicator":null===o?components.push(new LedIndicatorComponent({name:e.name,componentType:e.componentType,posX:e.posX,posY:e.posY,size:e.size,color:e.color,value:e.value})):o.setState(e);break;case"progressBar":null===o?components.push(new ProgressBarComponent({name:e.name,componentType:e.componentType,posX:e.posX,posY:e.posY,width:e.width,height:e.height,color:e.color,isVertical:e.isVertical,value:e.value,minValue:e.minValue,maxValue:e.maxValue})):o.setState(e);break;case"field":null===o?components.push(new ColorFieldComponent({name:e.name,componentType:e.componentType,posX:e.posX,posY:e.posY,width:e.width,height:e.height,color:e.color,outlineColor:e.outlineColor})):o.setState(e);break;case"slider":null===o&&components.push(new SliderComponent({name:e.name,componentType:e.componentType,posX:e.posX,posY:e.posY,width:e.width,height:e.height,color:e.color,maxValue:e.maxValue,minValue:e.minValue,value:e.value}));break;case"numberInput":null===o&&components.push(new NumberInputComponent({name:e.name,componentType:e.componentType,posX:e.posX,posY:e.posY,width:e.width,fontSize:e.fontSize,color:e.color,value:e.value}));break;case"button":null===o&&components.push(new ButtonComponent({name:e.name,componentType:e.componentType,posX:e.posX,posY:e.posY,width:e.width,height:e.height,fontSize:e.fontSize,color:e.color,textColor:e.textColor,isVertical:e.isVertical,text:e.text}))}}))},getElementIfIsRendered=e=>{let o=null;return components.forEach((n=>{n.name===e.name&&(o=n)})),o};initialFetch(),getData();
